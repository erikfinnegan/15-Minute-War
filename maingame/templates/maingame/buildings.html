{% extends "base.html" %}
{% load humanize %}

{% block title %}Buildings{% endblock %}

{% block tutorial %}
{% if active_user_settings.tutorial_step == 1 %}
<p>
    You're going to need some resources to do anything. Your resources appear at the top of the page and it might look like you have a lot of gold, but that's only just
    enough to construct buildings on all your available land! You start with {{ active_dominion.acres }} acres and each acre can support one building.
</p>
<p>Each building produces a different resource, but not all resources are equally important for dwarves.</p>
<p>Construct 50 farms to get food to feed your future units.</p>
<p>Construct 225 quarries to get the ore you'll need to train your units.</p>
<p>Construct 30 lumberyards to get the wood you'll need to build future buildings.</p>
<p>Construct 195 schools to get research to upgrade your buildings later.</p>
<p>We're not going to need any towers for our strategy.</p>
{% endif %}

{% if active_user_settings.tutorial_step == 2 %}
<p>Great! Now go to the Resources page.</p>
{% endif %}

{% if active_user_settings.tutorial_step == 6 %}
<p>Now that we've accumulated 60 ticks' worth of resources, it's time to train your army. Go to the Military page.</p>
{% endif %}

{% if active_user_settings.tutorial_step == 10 %}
<p>
    Now you're ready for war. Process ticks until there's only one left. It would be wise to spend your accumulated research and it would be optimal to revisit
    the Military page each tick to put some more units in training. I won't hold your hand for this, so do it however you see fit. I'll see you when you have
    one tick left.
</p>
{% endif %}

{% if active_user_settings.tutorial_step == 11 %}
<p>
    The rest of the menu has been unlocked. Take a few minutes to click around before processing your last tick and leaving protection. You'll want to check out
    the Overview, Spells, The World, News, Faction Info, and Options pages.
</p>
{% endif %}
{% endblock %}

{% block content %}
<div>
    <details class="accordion card card_colors max-w-md">
        <summary class="accordion__summary">Tutorial notes</summary>
        <p>
            While there are exceptions, most buildings produce resources each tick. Each has a cost to build with a primary and secondary resource. The cost
            per building increases depending on how many acres you have. Unlike units, buildings are constructed instantly. You can also destroy buildings,
            which is free and also instant. This offers no refunds, just a chance to build something else in its place.
        </p>
        <p>You can construct one building per acre. If you have fewer than that, the available space is referred to as "barren" acres.</p>
    </details>
    <h6>{{ active_dominion.barren_acres}} barren acres</h6>
    <p>
        Buildings cost {{ active_dominion.building_primary_cost|intcomma }} {{ primary_resource.name }} and 
        {{ active_dominion.building_secondary_cost|intcomma }} {{ secondary_resource.name }}. You can build {{ max_buildable|intcomma }}.
    </p>
    <form action="{% url 'submit_building' %}" method="post" class="">
        {% csrf_token %}

        <div class="u-flex u-flex-wrap u-gap-2">
        {% for building in buildings %}
        {% if building.quantity > 0 or building.is_buildable %}
        {% include "maingame/building_card.html" %}
        {% endif %}
        {% endfor %}
        </div>

        <div class="u-center u-flex u-gap-4 mt-2" style="width: fit-content">
            <select name="buildOrDestroy" class="w-16 h-6 u-center">
                <option selected>Build</option>
                <option>Destroy</option>
            </select>
            <button class="header_colors w-16 h-6 p-0 u-center" type="submit">
                <span class="font-bold">Submit</span>
            </button>
        </div>
    
    </form>
</div>
{% endblock %}